<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utkarsh Exam Portal</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        :root { --primary: #4361ee; --bg: #f0f2f5; --glass: rgba(255, 255, 255, 0.95); }
        body { font-family: 'Hind Siliguri', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; -webkit-tap-highlight-color: transparent; color: #1e293b; user-select: none; }
        
        /* Header Modernization */
        header { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 20px rgba(0,0,0,0.03); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .logo-text { font-weight: 800; font-size: 1.4rem; background: linear-gradient(45deg, #4361ee, #3f37c9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .fs-hint { font-size: 0.75rem; color: #94a3b8; text-align: center; margin-top: 8px; font-weight: 500; letter-spacing: 0.5px; }

        /* Grid Layout & Boxes */
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 20px; }
        .box { background: white; padding: 25px 15px; border-radius: 20px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.04); cursor: pointer; aspect-ratio: 1/1; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid white; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); position: relative; overflow: hidden; }
        .box:active { transform: scale(0.95); }
        .box img { width: 65px; height: 65px; border-radius: 14px; margin-bottom: 12px; object-fit: cover; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .box i { font-size: 3.5rem; color: var(--primary); margin-bottom: 15px; drop-shadow: 0 4px 10px rgba(67, 97, 238, 0.3); }
        .box-title { font-weight: 700; color: #334155; font-size: 1rem; }

        /* Modern Bottom Sheet */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); display: none; z-index: 998; backdrop-filter: blur(4px); transition: opacity 0.3s; }
        
        .sheet { 
            position: fixed; bottom: -100%; left: 0; width: 100%; 
            background: var(--glass); 
            backdrop-filter: blur(15px); 
            border-radius: 30px 30px 0 0; 
            padding: 10px 20px 20px 20px; box-sizing: border-box; 
            transition: bottom 0.5s cubic-bezier(0.32, 1, 0.23, 1); 
            height: 85vh; display: flex; flex-direction: column; z-index: 999; 
            box-shadow: 0 -10px 40px rgba(0,0,0,0.1); border-top: 1px solid rgba(255,255,255,0.5);
        }
        .sheet.active { bottom: 0; }
        
        /* Drag Handle */
        .sheet::before {
            content: ''; display: block; width: 40px; height: 5px; 
            background: #cbd5e1; border-radius: 10px; margin: 10px auto 20px auto;
        }
        
        .sheet-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; }
        .sheet-title { font-size: 1.5rem; font-weight: 800; color: #1e293b; }
        
        /* Modern Tabs */
        .tabs { display: flex; gap: 12px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .tab { background: rgba(255,255,255,0.6); color: #64748b; padding: 10px 22px; border-radius: 30px; white-space: nowrap; cursor: pointer; font-weight: 600; font-size: 0.95rem; transition: 0.2s; border: 1px solid rgba(0,0,0,0.05); }
        .tab.active { background: var(--primary); color: white; box-shadow: 0 5px 15px rgba(67, 97, 238, 0.4); border-color: transparent; }
        
        /* List Items */
        .list { overflow-y: auto; flex-grow: 1; margin-top: 15px; padding-bottom: 20px; }
        .item { display: flex; padding: 18px; background: white; margin-bottom: 12px; border-radius: 18px; text-decoration: none; color: #333; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.02); border: 1px solid rgba(255,255,255,0.5); transition: transform 0.1s; }
        .item:active { transform: scale(0.98); background: #f8fafc; }
        .icon-circle { width: 42px; height: 42px; background: #eff6ff; color: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 18px; font-size: 1.1rem; box-shadow: 0 4px 10px rgba(67, 97, 238, 0.15); }
        
        .loading { grid-column: span 2; text-align: center; color: #64748b; margin-top: 50px; font-weight: 500; }
    </style>
</head>
<body onclick="enableFullScreen()">

<header>
    <span class="logo-text">Exam Portal</span>
    <i class="fas fa-expand" onclick="forceFullScreen()" style="color:#4361ee; cursor:pointer; font-size:1.2rem;"></i>
</header>
<div class="fs-hint">যেকোনো জায়গায় টাচ করলে ফুল স্ক্রিন হবে</div>

<div class="grid" id="examGrid">
    <div class="loading"><i class="fas fa-spinner fa-spin"></i> লোডিং হচ্ছে...</div>
</div>

<div class="overlay" onclick="closeSheet()"></div>
<div class="sheet" id="sheet">
    <div class="sheet-header">
        <span class="sheet-title" id="sheetTitle">Exam</span>
        <i class="fas fa-times" onclick="closeSheet()" style="font-size:1.5rem; color:#94a3b8; cursor:pointer; padding: 5px;"></i>
    </div>
    <div class="tabs" id="tabContainer"></div>
    <div class="list" id="listContainer"></div>
</div>

<script>
    function enableFullScreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch((err) => console.log("FS blocked"));
            document.querySelector('.fs-hint').style.display = 'none';
        }
    }
    function forceFullScreen() {
        (!document.fullscreenElement) ? document.documentElement.requestFullscreen() : document.exitFullscreen();
    }

    const firebaseConfig = {
        apiKey: "AIzaSyDwGzTPmFg-gjoYtNWNJM47p22NfBugYFA",
        authDomain: "mock-test-1eea6.firebaseapp.com",
        databaseURL: "https://mock-test-1eea6-default-rtdb.firebaseio.com",
        projectId: "mock-test-1eea6",
        storageBucket: "mock-test-1eea6.firebaseapp.com",
        messagingSenderId: "111849173136",
        appId: "1:111849173136:web:8b211f58d854119e88a815",
        measurementId: "G-5RLWPTP8YD"
    };

    if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
    const db = firebase.database();
    let allData = [];

    db.ref('exams').on('value', (snapshot) => {
        const data = snapshot.val();
        const grid = document.getElementById('examGrid');
        grid.innerHTML = "";
        
        if(!data) { 
            grid.innerHTML = '<div class="loading">কোনো ডেটা পাওয়া যায়নি।</div>'; 
            return; 
        }

        allData = Object.values(data);
        const uniqueExams = [...new Set(allData.map(item => item.category))];

        uniqueExams.forEach(cat => {
            const item = allData.find(d => d.category === cat);
            let iconHtml = `<img src="${item.icon}">`;
            if(!item.icon || (!item.icon.startsWith('data:image') && !item.icon.startsWith('http'))) {
                iconHtml = `<i class="${item.icon || 'fas fa-graduation-cap'}"></i>`;
            }

            grid.innerHTML += `
                <div class="box" onclick="openSheet('${cat}')">
                    ${iconHtml}
                    <div class="box-title">${cat}</div>
                </div>
            `;
        });
    });

    window.openSheet = function(category) {
        enableFullScreen();
        document.getElementById('sheetTitle').innerText = category;
        const filtered = allData.filter(d => d.category === category);
        const subjects = [...new Set(filtered.map(d => d.subject))];
        
        const tabCont = document.getElementById('tabContainer');
        tabCont.innerHTML = "";
        
        subjects.forEach((sub, idx) => {
            tabCont.innerHTML += `<div class="tab ${idx===0?'active':''}" onclick="filterList('${category}', '${sub}', this)">${sub}</div>`;
        });

        if(subjects.length > 0) {
            filterList(category, subjects[0], document.querySelector('.tab'));
        } else {
            document.getElementById('listContainer').innerHTML = "<p style='text-align:center; color:#999; margin-top:20px;'>কোনো কনটেন্ট নেই।</p>";
        }
        
        document.querySelector('.overlay').style.display = 'block';
        document.getElementById('sheet').classList.add('active');
    }

    window.filterList = function(cat, sub, el) {
        if(el) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
        }
        
        const list = document.getElementById('listContainer');
        list.innerHTML = "";
        
        const items = allData.filter(d => d.category === cat && d.subject === sub);
        items.forEach(item => {
            list.innerHTML += `
                <a href="${item.link}" class="item">
                    <div class="icon-circle"><i class="fas fa-play"></i></div>
                    <div style="flex-grow:1; font-weight:600; font-size:0.95rem;">${item.chapter}</div>
                    <i class="fas fa-chevron-right" style="color:#cbd5e1;"></i>
                </a>
            `;
        });
    }

    window.closeSheet = function() {
        document.querySelector('.overlay').style.display = 'none';
        document.getElementById('sheet').classList.remove('active');
    }
</script>

</body>
</html>
